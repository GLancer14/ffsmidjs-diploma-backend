# Cайт-агрегатор поиска и бронирования книг в библиотеках (серверная часть)

Сслыка на клиентскую часть: [Клиентская часть](https://github.com/GLancer14/ffsmidjs-diploma-frontend)

Структура файлов и папок:
  - src - основная папка с файлами проекта
  - - auth - модуль аутентификации
  - - - guards - аутентификационные guards
  - - - strategies - стратегия аутентификации
  - - - types - типы для элементов модуля аутентификации
  - - bookRental - модуль аренды книг
  - - config - файлы конфигурации
  - - generated - сгенерированные Prisma файлы типов
  - - libraries - модуль управления библиотекой
  - - prisma - модуль ORM Prisma
  - - roles - декоратор и guard для авторизации пользователей
  - - supportChat - модуль управления чатом пользователей
  - - - guards - guards для клиентов и для аутентификации в сокет- соединении
  - - - types - типы для модуля чата
  - - types - общие типы
  - - users - модуль управления пользователями
  - - validation - pipes для пакета валидации joi
  - - websocket - содержит кастомный адаптер для веб-сокет подключения
  - prisma - папка содержит схему для ORM Prisma папку с миграция схемы в Postgres
  - .env.example - содержит пример необходимых для работы приложения переменных окружения для запуска в окружении хоста 
  - docker-compose.yml - файл для запуска приложения в окружении Docker
  - Dockerfile - конфигурация Docker для серверной части приложения
  - package.json - основной файл пакета npm
  
## Запуск приложения
### Docker
Для запуска приложения с помощью Docker необходимо разместить репозитории с серверной частью приложения (данный репозиторий) и [клиентской частью приложения](https://github.com/GLancer14/ffsmidjs-diploma-frontend) в одном каталоге, и переместить файл docker-compose.yml в этот каталог. Затем открыть терминал в данном каталоге и запустить команду: `docker compose up --build`.
После выполнения команды, в данном общем каталоге появится каталог volume.

### Окружение хоста
Для работы приложения в окружении хоста требуется, чтобы был запущен сервер PostgreSQL.
Для запуска в окружении хоста, также можно сохранить оба репозитория в одном каталоге, затем:
- для клиентской части: открыть терминал в каталоге с репозиторием и выполнить команды

    `npm install`

    `npm run dev`

- для серверной части: открыть терминал в каталоге с репозиторием и выполнить команды

    `npm install`

    `npx prisma migrate dev --name libraries-2`

    `npm run start:dev`

Логин, пароль и адрес сервера базы данных указываются в файле переменных окружения, примером которого является файл `.env.example`, располагающийся в корневом каталоге данного репозитория. Этот файл нужно переименовать в .env.

Для любого способа запуска, при запуске серверной части приложения, в базе данных создаётся пользователь-администратор с данными для аутентификации из переменных окружения `ADMIN_EMAIL` и `ADMIN_PASSWORD`. За данного пользвоателя можно аутентифицироваться в приложении и добавлять контент, соответствующий роли "Администратор".

Технологии, которые не изучались в программе профессии - 
  - пакет prisma для [Prisma ORM](https://www.prisma.io/),
  - реляционные базы данных,
  - продвинутый React,
  - [Redux](https://redux.js.org/) и [Redux Toolkit](https://redux-toolkit.js.org/),
  - [Axios](https://axios-http.com/)
  - [SASS](https://sass-lang.com/)